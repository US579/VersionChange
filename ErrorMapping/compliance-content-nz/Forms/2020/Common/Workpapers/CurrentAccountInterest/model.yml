---
name: Current account - interest on overdrawn
model:
  fields:
    PeriodEndDate:
      type: date
      value: = DATE(2020,03,31)
    PeriodStartDate:
      type: date
      value: = DATE(2019,04,01)

    Date1:
      type: text
      defaultValue: April 2019
    Date2:
      type: text
      defaultValue: May 2019
    Date3:
      type: text
      defaultValue: June 2019
    Date4:
      type: text
      defaultValue: July 2019
    Date5: 
      type: text
      defaultValue: August 2019
    Date6:
      type: text
      defaultValue: September 2019
    Date7:
      type: text
      defaultValue: October 2019
    Date8:
      type: text
      defaultValue: November 2019
    Date9:
      type: text
      defaultValue: December 2019
    Date10:
      type: text
      defaultValue: January 2020
    Date11:
      type: text
      defaultValue: February 2020
    Date12:
      type: text
      defaultValue: March 2020

    DebitRate1:
      type: number
      defaultValue: '5.77'
    DebitRate2:
      type: number
      defaultValue: '5.77'
    DebitRate3:
      type: number
      defaultValue: '5.77'
    DebitRate4:
      type: number
      defaultValue: '5.77'
    DebitRate5:
      type: number
      defaultValue: '5.77'
    DebitRate6:
      type: number
      defaultValue: '5.77'
    DebitRate7:
      type: number
      defaultValue: '5.77'
    DebitRate8:
      type: number
      defaultValue: '5.77'
    DebitRate9:
      type: number
      defaultValue: '5.77'
    DebitRate10:
      type: number
      defaultValue: '5.77'
    DebitRate11:
      type: number
      defaultValue: '5.77'
    DebitRate12:
      type: number
      defaultValue: '5.77'

    NameofPerson:
      type: text
    CompoundInterest:
      type: boolean
      defaultValue: true

    OpeningBalance:
      type: number
    ShareholderSalary:
      type: number
    OpeningBalanceplusSalary:
      type: number
      value: = OpeningBalance + ShareholderSalary
    OtherOpeningAdjustmentsDR:
      type: number
    OtherOpeningAdjustmentsCR:
      type: number
    OpeningBalanceplusAdjustments:
      type: number
      value: = OpeningBalanceplusSalary - OtherOpeningAdjustmentsDR + OtherOpeningAdjustmentsCR

    Withdrawal1:
      type: number
    Contribution1:
      type: number
    Balance1:
      type: number
      value: = OpeningBalanceplusAdjustments - Withdrawal1 + Contribution1
    CreditRate1:
      type: number
    Interest1:
      type: number
      value: = IF(
                  (OpeningBalanceplusAdjustments + Balance1)/2 < 0,
                    0 - ROUND((OpeningBalanceplusAdjustments + Balance1)/2 * DebitRate1 / 100 / 12,2),
                    0 - ROUND((OpeningBalanceplusAdjustments + Balance1)/2 * CreditRate1 / 100 / 12,2)
                  )

    Withdrawal2:
      type: number
    Contribution2:
      type: number
    Balance2:
      type: number
      value: = IF(CompoundInterest, 
                    Balance1 - Withdrawal2 + Contribution2 + Interest1 ,
                    Balance1 - Withdrawal2 + Contribution2 
                  )
    CreditRate2:
      type: number
    Interest2:
      type: number
      value: = IF(
                  (Balance1 + Balance2)/2 < 0,
                    0 - ROUND((Balance1 + Balance1)/2 * DebitRate2 / 100 /12,2),
                    0 - ROUND((Balance1 + Balance1)/2 * CreditRate2 / 100 /12,2)
                  )

    Withdrawal3:
      type: number
    Contribution3:
      type: number
    Balance3:
      type: number
      value: = IF(CompoundInterest, 
                    Balance2 - Withdrawal3 + Contribution3 + Interest2 ,
                    Balance2 - Withdrawal3 + Contribution3 
                  )
    CreditRate3:
      type: number
    Interest3:
      type: number
      value: = IF(
                  (Balance2 + Balance3)/2 < 0,
                    0 - ROUND((Balance2 + Balance3)/2 * DebitRate3 / 100 /12,2),
                    0 - ROUND((Balance2 + Balance3)/2 * CreditRate3 / 100 /12,2)
                  )

    Withdrawal4:
      type: number
    Contribution4:
      type: number
    Balance4:
      type: number
      value: = IF(CompoundInterest, 
                    Balance3 - Withdrawal4 + Contribution4 + Interest3 ,
                    Balance3 - Withdrawal4 + Contribution4 
                  )
    CreditRate4:
      type: number
    Interest4:
      type: number
      value: = IF(
                  (Balance3 + Balance4)/2 < 0,
                    0 - ROUND((Balance3 + Balance4)/2 * DebitRate4 / 100 /12,2),
                    0 - ROUND((Balance3 + Balance4)/2 * CreditRate4 / 100 /12,2)
                  )

    Withdrawal5:
      type: number
    Contribution5:
      type: number
    Balance5:
      type: number
      value: = IF(CompoundInterest, 
                    Balance4 - Withdrawal5 + Contribution5 + Interest4 ,
                    Balance4 - Withdrawal5 + Contribution5 
                  )
    CreditRate5:
      type: number
    Interest5:
      type: number
      value: = IF(
                  (Balance4 + Balance5)/2 < 0,
                    0 - ROUND((Balance4 + Balance5)/2 * DebitRate5 / 100 /12,2),
                    0 - ROUND((Balance4 + Balance5)/2 * CreditRate5 / 100 /12,2)
                  )

    Withdrawal6:
      type: number
    Contribution6:
      type: number
    Balance6:
      type: number
      value: = IF(CompoundInterest, 
                    Balance5 - Withdrawal6 + Contribution6 + Interest5 ,
                    Balance5 - Withdrawal6 + Contribution6 
                  )
    CreditRate6:
      type: number
    Interest6:
      type: number
      value: = IF(
                  (Balance5 + Balance6)/2 < 0,
                    0 - ROUND((Balance5 + Balance6)/2 * DebitRate6 / 100 /12,2),
                    0 - ROUND((Balance5 + Balance6)/2 * CreditRate6 / 100 /12,2)
                  )

    Withdrawal7:
      type: number
    Contribution7:
      type: number
    Balance7:
      type: number
      value: = IF(CompoundInterest, 
                    Balance6 - Withdrawal7 + Contribution7 + Interest6 ,
                    Balance6 - Withdrawal7 + Contribution7 
                  )
    CreditRate7:
      type: number
    Interest7:
      type: number
      value: = IF(
                  (Balance6 + Balance7)/2 < 0,
                    0 - ROUND((Balance6 + Balance7)/2 * DebitRate7 / 100 /12,2),
                    0 - ROUND((Balance6 + Balance7)/2 * CreditRate7 / 100 /12,2)
                  )

    Withdrawal8:
      type: number
    Contribution8:
      type: number
    Balance8:
      type: number
      value: = IF(CompoundInterest, 
                    Balance7 - Withdrawal8 + Contribution8 + Interest7 ,
                    Balance7 - Withdrawal8 + Contribution8 
                  )
    CreditRate8:
      type: number
    Interest8:
      type: number
      value: = IF(
                  (Balance7 + Balance8)/2 < 0,
                    0 - ROUND((Balance7 + Balance8)/2 * DebitRate8 / 100 /12,2),
                    0 - ROUND((Balance7 + Balance8)/2 * CreditRate8 / 100 /12,2)
                  )

    Withdrawal9:
      type: number
    Contribution9:
      type: number
    Balance9:
      type: number
      value: = IF(CompoundInterest, 
                    Balance8 - Withdrawal9 + Contribution9 + Interest8 ,
                    Balance8 - Withdrawal9 + Contribution9 
                  )
    CreditRate9:
      type: number
    Interest9:
      type: number
      value: = IF(
                  (Balance8 + Balance9)/2 < 0,
                    0 - ROUND((Balance8 + Balance9)/2 * DebitRate9 / 100 /12,2),
                    0 - ROUND((Balance8 + Balance9)/2 * CreditRate9 / 100 /12,2)
                  )

    Withdrawal10:
      type: number
    Contribution10:
      type: number
    Balance10:
      type: number
      value: = IF(CompoundInterest, 
                    Balance9 - Withdrawal10 + Contribution10 + Interest9 ,
                    Balance9 - Withdrawal10 + Contribution10 
                  )
    CreditRate10:
      type: number
    Interest10:
      type: number
      value: = IF(
                  (Balance9 + Balance10)/2 < 0,
                    0 - ROUND((Balance9 + Balance10)/2 * DebitRate10 / 100 /12,2),
                    0 - ROUND((Balance9 + Balance10)/2 * CreditRate10 / 100 /12,2)
                  )

    Withdrawal11:
      type: number
    Contribution11:
      type: number
    Balance11:
      type: number
      value: = IF(CompoundInterest, 
                    Balance10 - Withdrawal11 + Contribution11 + Interest10 ,
                    Balance10 - Withdrawal11 + Contribution11 
                  )
    CreditRate11:
      type: number
    Interest11:
      type: number
      value: = IF(
                  (Balance10 + Balance11)/2 < 0,
                    0 - ROUND((Balance10 + Balance11)/2 * DebitRate11 / 100 /12,2),
                    0 - ROUND((Balance10 + Balance11)/2 * CreditRate11 / 100 /12,2)
                  )

    Withdrawal12:
      type: number
    Contribution12:
      type: number
    Balance12:
      type: number
      value: = IF(CompoundInterest, 
                    Balance11 - Withdrawal12 + Contribution12 + Interest11 ,
                    Balance11 - Withdrawal12 + Contribution12 
                  )
    CreditRate12:
      type: number
    Interest12:
      type: number
      value: = IF(
                  (Balance11 + Balance12)/2 < 0,
                    0 - ROUND((Balance11 + Balance12)/2 * DebitRate12 / 100 /12,2),
                    0 - ROUND((Balance11 + Balance12)/2 * CreditRate12 / 100 /12,2)
                  )


    TotalInterest:
      type: number
      value:  = Interest1 + Interest2 + Interest3 + Interest4 + Interest5 + Interest6 
              + Interest7 + Interest8 + Interest9 + Interest10 + Interest11 + Interest12

    TotalWithdrawals:
      type: number
      value:  = OtherOpeningAdjustmentsDR + Withdrawal1 + Withdrawal2 + Withdrawal3 + Withdrawal4 + Withdrawal5 + Withdrawal6 
              + Withdrawal7 + Withdrawal8 + Withdrawal9 + Withdrawal10 + Withdrawal11 + Withdrawal12

    TotalContributions:
      type: number
      value:  = ShareholderSalary + OtherOpeningAdjustmentsCR + Contribution1 + Contribution2 + Contribution3 + Contribution4 + Contribution5 + Contribution6 
              + Contribution7 + Contribution8 + Contribution9 + Contribution10 + Contribution11 + Contribution12

    LedgerDetails:
      type: list
      fields:
        AccountName:
          type: text
    AccountNameFromList:
      type: text
      value: = LedgerDetails:AccountName

    LedgerAmounts:
      type: list
      fields:
        AccountName:
          type: text
          value: = AccountNameFromList
        AccountCode:
          type: text
        Balance:
          type: number

    TotalBalance:
      type: number
      value: '=SUM(LedgerAmounts:Balance)'
    Variance:
      type: number
      value: '=TotalInterest + TotalBalance'

    NotesList:
      type: list
      fields:
        Note:
          type: textArea
